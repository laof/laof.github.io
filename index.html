<p><a href="https://github.com/laof?tab=repositories" target="_blank">repositories</a></p>
<p id="time"></p>
<ul id="index"></ul>
<br />
<ul id="files"></ul>
<script>
  fetch('page.json')
    .then((res) => res.json())
    .then((list) => {
      const html = list.map((obj) => {
        return `<li><a href="${obj.link}" target="_blank">${obj.name}</a></li>`
      })

      document.querySelector('#index').innerHTML = html.join('')
    })

  function files(path, data = [], arr = []) {
    for (let index = 0; index < data.length; index++) {
      const obj = data[index]
      const oc = obj.children
      if (!Array.isArray(oc)) {
        obj.link = `${path}/${obj.name}`
        arr.push(obj)
      } else if (oc.length) {
        files(`${path}/${obj.name}`, oc, arr)
      }
    }
    return arr
  }

  fetch('data.json')
    .then((res) => res.json())
    .then((res) => {
      if (!res) {
        return
      }
      const ori = location.origin
      document.querySelector('#time').innerHTML = 'last update time ' + res.time
      const list = files('', res.files)
      const html = list.map((obj) => {
        return `<li><a href="${ori}${obj.link}" target="_blank">${obj.link} ${obj.size}</a></li>`
      })

      document.querySelector('#files').innerHTML = html.join('')
    })

  function files(path, data = [], arr = []) {
    for (let index = 0; index < data.length; index++) {
      const obj = data[index]
      const oc = obj.children
      if (!Array.isArray(oc)) {
        obj.link = `${path}/${obj.name}`
        arr.push(obj)
      } else if (oc.length) {
        files(`${path}/${obj.name}`, oc, arr)
      }
    }
    return arr
  }
</script>
